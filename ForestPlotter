#%%
import Modeler as m
import Dataloader as dl
import matplotlib.pyplot as plt
from sklearn import tree as sk_tree
import numpy as np

# %%
feature_names = np.array(dl.vectorizer.get_feature_names_out())

#plots the five trees in rf_5_random
for i in range(5):
    plt.figure(figsize=(20,10))
    sk_tree.plot_tree(
        m.rf_5_random.estimators_[i], 
        feature_names=feature_names, 
        class_names=['int','ex'], 
        filled=True, 
        max_depth=5,      
        fontsize=6
    )
    plt.savefig(f"tree_{i+1}_of_5.png");
# %%
#plots the tree in rf_1_stratify
plt.figure(figsize=(20,10))
sk_tree.plot_tree(
    m.rf_1_stratify.estimators_[0], 
    feature_names=feature_names, 
    class_names=['int','ex'], 
    filled=True, 
    max_depth=8,      
    fontsize=6
)
plt.savefig(f"only_one_tree.png")